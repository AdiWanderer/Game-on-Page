// Minesweeper game implementation in JavaScript

// Create and initialize the Minesweeper board
const createBoard = (rows, cols, mines) => {
  const board = Array.from({ length: rows }, () => Array(cols).fill({ value: 0, revealed: false }));

  // Place mines randomly
  let placedMines = 0;
  while (placedMines < mines) {
    const row = Math.floor(Math.random() * rows);
    const col = Math.floor(Math.random() * cols);
    if (board[row][col].value !== 'M') {
      board[row][col] = { value: 'M', revealed: false };
      placedMines++;
      
      // Update numbers around the mine
      for (let i = -1; i <= 1; i++) {
        for (let j = -1; j <= 1; j++) {
          const newRow = row + i;
          const newCol = col + j;
          if (
            newRow >= 0 && newRow < rows &&
            newCol >= 0 && newCol < cols &&
            board[newRow][newCol].value !== 'M'
          ) {
            board[newRow][newCol] = {
              ...board[newRow][newCol],
              value: board[newRow][newCol].value + 1,
            };
          }
        }
      }
    }
  }

  return board;
};

const revealCell = (board, row, col) => {
  if (
    row < 0 || row >= board.length ||
    col < 0 || col >= board[0].length ||
    board[row][col].revealed
  ) {
    return;
  }

  board[row][col].revealed = true;

  if (board[row][col].value === 0) {
    for (let i = -1; i <= 1; i++) {
      for (let j = -1; j <= 1; j++) {
        revealCell(board, row + i, col + j);
      }
    }
  }
};

const renderBoard = (board) => {
  const container = document.getElementById('minesweeper');
  container.innerHTML = '';

  board.forEach((row, rowIndex) => {
    const rowElement = document.createElement('div');
    rowElement.className = 'row';

    row.forEach((cell, colIndex) => {
      const cellElement = document.createElement('div');
      cellElement.className = 'cell';

      if (cell.revealed) {
        cellElement.classList.add('revealed');
        cellElement.textContent = cell.value === 0 ? '' : cell.value === 'M' ? 'ðŸ’£' : cell.value;
      } else {
        cellElement.addEventListener('click', () => {
          if (cell.value === 'M') {
            alert('Game Over!');
            revealAll(board);
          } else {
            revealCell(board, rowIndex, colIndex);
          }
          renderBoard(board);
        });
      }

      rowElement.appendChild(cellElement);
    });

    container.appendChild(rowElement);
  });
};

const revealAll = (board) => {
  board.forEach(row => row.forEach(cell => cell.revealed = true));
};

// Initialization
const rows = 10;
const cols = 10;
const mines = 15;
const board = createBoard(rows, cols, mines);

// Render the board on the webpage
document.body.innerHTML = '<div id="minesweeper"></div>';
document.head.innerHTML += `
  <style>
    #minesweeper {
      display: grid;
      grid-template-rows: repeat(${rows}, 30px);
      grid-template-columns: repeat(${cols}, 30px);
      gap: 2px;
    }
    .row {
      display: flex;
    }
    .cell {
      width: 30px;
      height: 30px;
      background: lightgray;
      text-align: center;
      line-height: 30px;
      border: 1px solid #ccc;
      cursor: pointer;
      font-size: 16px;
      font-family: Arial, sans-serif;
    }
    .cell.revealed {
      background: white;
      cursor: default;
    }
  </style>
`;
renderBoard(board);
